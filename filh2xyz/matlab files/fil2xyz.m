 function [X,Y,Z]= fil2xyz(Fi,Lambda,h)

 
%PURPOSE
%GEODETIC COORDINATES --> 3D CARTESIAN  COORDINATES.
%INPUTS:
%       fi,lambda,h : Station geodetic Coordinate,
%       ellipsoid   :  WGS84.
%OUTPUTS:
%       X,Y,Z       : CARTESIAN  COORDINATES. 
% Mehran ghandehary
% 2008

%  WGS84   a = 6378137.000000 ; b = 6356752.314245; f= 1/298.257223563; 

      a = 6378137.000000 ;      
      b = 6356752.314245; 
      f= 1/298.257223563;


% ellipsoids 
% 01 Airy 1830                                  a = 6377563.396000 ; b = 6356256.909237;  
% 02 Airy 1849                                  a = 6377340.189000 ; b = 6356034.447897;  
% 03 Airy Modified 1965                         a = 6377340.189000 ; b = 6356034.447939;  
% 04 Australian National                        a = 6378160.000000 ; b = 6356774.719195;  
% 05 Average Terrestrial System 1977            a = 6378135.000000 ; b = 6356750.304922;  
% 06 Bessel (Namibia 1841)                      a = 6377483.865000 ; b = 6356165.382967;  
% 07 Bessel (Ethiopia, Indonesia 1841)          a = 6377397.155000 ; b = 6356078.962819;  
% 08 Bessel (Japan 1841)                        a =6377397.155000  ; b = 6356078.963000;  
% 09 Modified Bessel                            a = 6377492.018000 ; b = 6356173.508713;  
% 10 Bessel NGO                                 a = 6377492.018000 ; b = 6356173.508516;  
% 11 Bessel RT90                                a = 6377397.154000 ; b = 6356078.962024;  
% 12 Clarke 1858                                a = 6378294.000000 ; b = 6356621.237513;  
% 13 Clarke 1858 (AUSLIG)                       a = 6378293.645000 ; b = 6356617.937649;  
% 14 Clarke 1858-1                              a = 6378293.639000 ; b = 6356617.981760 ; 
% 15 Clarke 1866                                a = 6378206.400000 ; b = 6356583.799999;  
% 16 Clarke Michigan                            a = 6378450.047000 ; b = 6356826.621424;  
% 17 Clarke 1880                                a = 6378249.136000 ; b = 6356514.860580;  
% 18 Clarke 1880 ARC50                          a = 6378249.145000 ; b = 6356514.966716 ; 
% 19 Clarke 1880 Benoit                         a = 6378300.790000 ; b = 6356566.429659;  
% 20 Clarke 1880 Benoit                         a = 6378300.790000 ; b = 6356566.434997;  
% 21 Clarke 1880 IGN                            a = 6378249.200000 ; b = 6356515.000000;  
% 22 Clarke 1880 Jamaica                        a = 6378249.136000 ; b = 6356514.957600;  
% 23 Clarke 1880 Merchich                       a = 6378249.200000 ; b = 6356514.996942;  
% 24 Clarke 1880 Palestine                      a = 6378300.790000 ; b = 6356566.429662;  
% 25 Clarke 1880 RGS                            a = 6378249.145000 ; b = 6356514.869550;  
% 26 Clarke 1880 SGA 1922                       a = 6378249.200000 ; b = 6356514.996942 ; 
% 27 Everest (India 1830)                       a = 6377276.345000 ; b = 6356075.413138;  
% 28 Everest (Sabah & Sarawak)                  a = 6377298.556000 ; b = 6356097.550301;  
% 29 Everest (India 1956)                       a = 6377301.243000 ; b = 6356100.228366;  
% 30 Everest (W. Malaysia 1969)                 a = 6377295.664000 ; b = 6356094.667913;  
% 31 Everest (W. Malaysia & Singapure 1948)     a = 6377304.063000 ; b = 6356103.038991;  
% 32 Everest (Pakistan)                         a = 6377309.613000 ; b = 6356108.570542;  
% 33 Everest (Timbalai)                         a = 6377298.561000 ; b = 6356097.555284;  
% 34 Everest 1967                               a = 6377298.556000 ; b = 6356097.550299;  
% 35 Fischer 1960                               a = 6378166.000000 ; b = 6356784.283607;  
% 36 Fischer 1968                               a = 6378150.000000 ; b = 6356768.337244;  
% 37 Modified Fischer 1966                      a = 6378155.000000 ; b = 6356773.320483;  
% 38 GEM 10C                                    a = 6378137.000000 ; b = 6356752.313990;  
% 39 GRS67                                      a = 6378160.000000 ; b = 6356774.516091;  
% 40 GRS80                                      a = 6378137.000000 ; b = 6356752.314140;  
% 41 Hayford 1909                               a = 6378388.000000 ; b = 6356911.946128;  
% 42 Helmert 1906                               a = 6378200.000000 ; b = 6356818.169628;  
% 43 Hough 1960                                 a = 6378270.000000 ; b = 6356794.343434;  
% 44 IAG 75                                     a = 6378140.000000 ; b = 6356755.304075;  
% 45 Indonesian 1974                            a = 6378160.000000 ; b = 6356774.508046;  
% 46 International 1909                         a = 6378388.000000 ; b = 6356911.949128;  
% 47 International 1924                         a = 6378388.000000 ; b = 6356911.949128;  
% 48 IUGG 67                                    a = 6378160.000000 ; b = 6356774.719195;  
% 49 IUGG 75                                    a = 6378140.000000 ; b = 6356755.288158;  
% 50 Kaula                                      a = 6378165.000000 ; b = 6356344.387615;  
% 51 Krasovsky 1940                             a = 6378245.000000 ; b = 6356863.018773;  
% 52 Merit 83                                   a = 6378137.000000 ; b = 6356752.298216;  
% 53 Mercury 1960                               a = 6378166.000000 ; b = 6356748.283666;  
% 54 Modified Mercury 1968                      a = 6378150.000000 ; b = 6356768.337303;  
% 55 New International 1967                     a = 6378157.500000 ; b = 6356772.227578;  
% 56 NWL 10D                                    a = 6378135.000000 ; b = 6356750.520016;  
% 57 NWL 9D                                     a = 6378145.000000 ; b = 6356759.769489;  
% 58 OSU86F                                     a = 6378136.200000 ; b = 6356751.516672;  
% 59 OSU91A                                     a = 6378136.300000 ; b = 6356751.616337;  
% 60 Plessis 1817                               a = 6376523.000000 ; b = 6355862.933256;  
% 61 SGS85                                      a = 6378136.000000 ; b = 6356774.719201;  
% 62 South American 1969                        a = 6378160.000000 ; b = 6356774.719195;  
% 63 South Asia                                 a = 6378155.000000 ; b = 6356773.320497;  
% 64 Struve (Spain) 1860                        a = 6378298.300000 ; b = 6356657.142670;  
% 65 Walbeck 1817                               a = 6376896.000000 ; b = 6355834.846687;  
% 66 War Office                                 a = 6378300.583000 ; b = 6356752.270220;  
% 67 WGS60                                      a = 6378165.000000 ; b = 6356783.286969;  
% 68 WGS66                                      a = 6378145.000000 ; b = 6356759.769489;  
% 69 WGS72                                      a = 6378135.000000 ; b = 6356750.520016;  
% 70 WGS84                                      a = 6378137.000000 ; b = 6356752.314245;  
 e=sqrt((a^2-b^2)/a^2);
 N=a/sqrt(1-(e^2*(sin(Fi))^2));
 X=(N+h)*cos(Fi)*cos(Lambda);
 Y=(N+h)*cos(Fi)*sin(Lambda);
 Z=((b^2/a^2)*N+h)*sin(Fi);
